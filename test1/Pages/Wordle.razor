@page "/wordle"

@using System.Text.Json
@using test1.Pages.Components;
@using test1.Wordle.Classes;
@inject Stats stats
@inject test1.Services.SpinnerService SpinnerService
@inject HttpClient Http

<PageTitle>Wordle</PageTitle>

@if (correctWord != null)
{
	<WordleKeyboardHost Solution=@correctWord OnGameCompleted="completeDaily"/>

	<RobotWordle Solution=@correctWord Hide=@HideRobot/> 
}
@code {
	string? correctWord{ get;set; }
	WordResponse? dailyWord { get; set; }

	bool HideRobot { get; set; } = true;
	override protected async Task OnInitializedAsync()
	{
		try
		{

			SpinnerService.Show();

			dailyWord = await Http.GetFromJsonAsync<WordResponse>("daily-word.json");
			var date = DateTime.Today.ToString("yyyy-MM-dd");

			correctWord = dailyWord.Solution;
		}
		catch (Exception ex)
		{
			Console.Error.WriteLine(ex);
		}

		await stats.LoadAsync();
		SpinnerService.Hide();
	}

	public class WordResponse
	{
		public string Solution { get; set; }
	}

	public void completeDaily()
	{
		HideRobot = false;
	}
}